{% load i18n media creme_menu creme_core_tags creme_search creme_quickforms %}
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="{{LANGUAGE_CODE}}" xml:lang="{{LANGUAGE_CODE}}" {% if LANGUAGE_BIDI %}dir="rtl"{% endif %}>
<head>
    <meta http-equiv="Content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />{% comment %}<meta http-equiv="X-UA-Compatible" content="IE=8" />{% endcomment %}
    <title>{% block page_title %}{% endblock %}Creme CRM</title>
    <script type='text/javascript'>
        var THEME_NAME = "{{THEME_NAME}}";
    </script>
    <!--
        Firebug for browsers without plugin/extension :
            - uncomment the following script
            - add debug="true" to <html> tag
    -->
    <!--script type="text/javascript" src="https://getfirebug.com/firebug-lite.js"></script-->
    {% include_creme_media "main.css" %}
    {% include "creme_core/frags/js_header.html" %}
    <link rel="shortcut icon" href="{% media_url 'common/images/favicon.ico' %}" type="image/x-icon" />
    <style type="text/css"> {# TODO: move to CSS #}
      {% if OLD_MENU %}
        .fg-menu-container { z-index: 100; }
      {% else %}
        /* TODO: move to CSS when OLD_MENU has been removed */
        div.main_content {
            padding-top: 40px;
        }
{% comment %}
        #top {
            margin-top: 50px;
        }
{% endcomment %}
      {% endif %}
    </style>
    {% block extrahead %}{% endblock %}
</head>
{# <body {% block bodyclass %}{% endblock %} #}
<body class="{% block body_classes %}{% endblock %}"
      data-save-relations-url="{% url 'creme_core__save_relations' %}"
      data-select-relations-objects-url="{% url 'creme_core__select_entities_to_link' %}"
      {% url_join bricks_reload_url base_url=request.path as bricks_reload_uri %}{% if bricks_reload_uri %}data-bricks-reload-url="{{bricks_reload_uri}}"{% endif %}
      data-brick-state-url="{% url 'creme_core__set_brick_state' %}"
>
{% if OLD_MENU %}
    {% block side_menu %}
        <div id="menu_collapse" class="ui-corner-all menu_collapse">
            <img src="{% creme_media_url 'images/favicon.ico' %}"/>
            M<br/>
            E<br/>
            N<br/>
            U<br/>
            &nbsp;<br/>
            C<br/>
            R<br/>
            E<br/>
            M<br/>
            E<br/>
        </div>
        <div id="menu_expanded" class="menu_expanded">
            <div id="logo_container">
                <center>
                    <a href="/"><img src="{% creme_media_url logo_url %}" alt="Logo" class="logo pointer"/></a>
                </center>
            </div>
            {% block sidebar %}
                <a tabindex="0" href="#tree_menu2" class="fg-button fg-button-icon-right ui-widget ui-state-default ui-corner-all" id="menu">
                    Menu
                </a>
                <div id="tree_menu2" style="display:none;">
                    {% generate_treecreme_menu request %}
                </div>
            {% endblock %}
        </div>
    {% endblock %}

    {% block top_bar %}
        <div id="top" class="header">
            <div class="widget">
                {% blocktrans %}Welcome, <strong>{{user}}</strong> (Time zone: {{TIME_ZONE}}){% endblocktrans %} -
                {% block userlinks %}
                    <a href="{% url 'creme_config__user_settings' %}">{% trans 'My settings' %}</a> -
                    <a href="{% url 'creme_logout' %}">{% trans 'Log out' %}</a> -
                    <a href="{% url 'creme_core__trash' %}">
                        {% trans 'Trash' as trash_label %} <img src="{% creme_media_url 'images/delete_16.png' %}" alt="{{trash_label}}" title="{{trash_label}}" />{{trash_label}}
                    </a> -
                    {% if user.is_superuser %}
                        <a href="{% url 'creme_core__my_jobs' %}">{% trans 'Jobs' %}</a>
                    {% else %}
                        <a href="{% url 'creme_core__jobs' %}">{% trans 'My jobs' %}</a>
                    {% endif %}
                {% endblock %}
            </div>
            <div class="widget major">
                {% get_search_panel %}
                {% get_quickforms_panel %}
            </div>
        </div>
    {% endblock %}
{% else %}
    {% include 'creme_core/frags/header_menu.html' %}
{% endif %}

    <div id="content" class="main_content">
        {% if OLD_MENU %}
            {% block last_viewed_items %}
                {% get_last_items_menu request %}
            {% endblock %}

            {% block prefered_menu %}
                {% get_prefered_menu request %}
            {% endblock %}
        {% endif %}

        <div id="sub_content">
            {% block before_content_1 %}
            {% endblock %}

            {% block before_content_2 %}
            {% endblock %}

            {% block before_content_3 %}
            {% endblock %}

            {% block content %}
            {% endblock %}

            {% block after_content_1 %}
            {% endblock %}

            {% block after_content_2 %}
            {% endblock %}

            {% block after_content_3 %}
            {% endblock %}
        </div>
    </div>

    {% include 'footer/footer.html' %}

    <script type="text/javascript">
        $(document).ready(function() {
          {% if OLD_MENU %}
            creme.menu.sideMenu({
                title: '{% trans "Menu" %}',
                back: '{% trans "Back to Top" %}'
            });
          {% endif %}

            creme.blocks.bindEvents();
        });
    </script>
</body>
</html>
