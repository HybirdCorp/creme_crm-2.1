{% load i18n %}
{% load creme_core_tags %}
<tr id="list_thead_search" class="columns_bottom">
    {% if not o2m %}<th class="choices"><center><input name="select_all" value="all" type="checkbox" title="{% trans "Select all" %}"/></center></th>{% endif %}
    {% for cell in cells %}
        {% with cell.widget_ctx as widget_ctx %}{% with widget_ctx.type as widget_type %}
            <th {% if cell.is_hidden %}style="display:none;"{% endif %} class="{% if cell.type_id != 'actions' %}column {{cell.header_listview_css_class}}{% else %}actions{% endif %}{% if widget_ctx.value %} search{% endif %}{% if cell.sortable %} sortable{% endif %}{% if cell.has_a_filter %} {{widget_type}}{% endif %}">
                {% if cell.has_a_filter %}
                    {% if widget_type == "select" %}
                        <select name="{{cell.key}}" title="{{cell.title}}" onkeydown="$(this.form).list_view('getKdSubmit')(event, this, {'_search': 1});">
                            <option value="">{% trans "Select" %}</option>
                            {% for options in widget_ctx.values %}
                                <option value="{{options.value}}" {% if search %}{{options.selected}}{% endif %} {% if options.value == NULL_FK %}class="search-nullfk"{% endif %}>{{options.text}}</option>
                            {% endfor %}
                        </select>
                    {% elif widget_type == "checkbox" %}
                        <select name="{{cell.key}}" title="{{cell.title}}" onkeydown="$(this.form).list_view('getKdSubmit')(event, this, {'_search': 1});">
                            <option value="">{% trans "Select" %}</option>
                            {% for options in widget_ctx.values %}
                                <option value="{{options.value}}" {% if search %}{{options.selected}}{% endif %}>{{options.text}}</option>
                            {% endfor %}
                        </select>
                    {% elif widget_type == "datefield" %}
                        <span>
                            <label for="id_{{cell.value}}{{whoami}}">{% trans "Between" %}</label>
                            <input name="{{cell.key}}" id="id_{{cell.key}}{{whoami}}" title="{{cell.title}}" type="{{widget_type}}"
                                    style="width:80px" value="{% if search %}{{widget_ctx.values.start}}{% endif %}"
                                    onkeydown="$(this.form).list_view('getKdSubmit')(event, this, {'_search': 1});" class="first"/>
                            &nbsp;<label for="id_{{cell.value}}{{whoami}}_2">{% trans "and" %}</label>&nbsp;
                            <input name="{{cell.key}}" id="id_{{cell.key}}{{whoami}}_2" title="{{cell.title}}" type="{{widget_type}}"
                                    style="width:80px" value="{% if search %}{{widget_ctx.values.end}}{% endif %}"
                                    onkeydown="$(this.form).list_view('getKdSubmit')(event, this, {'_search': 1});" class="second"/>
                        </span>
                        <script type="text/javascript">
                            $("#id_{{cell.key}}{{whoami}}").datepicker({dateFormat:   "yy-mm-dd", showOn: "button", buttonImage: "{% creme_media_url 'images/icon_calendar.gif' %}", buttonImageOnly: true });
                            $("#id_{{cell.key}}{{whoami}}_2").datepicker({dateFormat: "yy-mm-dd", showOn: "button", buttonImage: "{% creme_media_url 'images/icon_calendar.gif' %}", buttonImageOnly: true });
                        </script>
                    {% elif widget_type == "text" %}
                        <input name="{{cell.key}}" title="{{cell.title}}" type="text" value="{% if search %}{{widget_ctx.value}}{% endif %}" onkeydown="$(this.form).list_view('getKdSubmit')(event, this, {'_search': 1});"/>
                    {% endif %}
                {% endif %}
                {% if cell.type_id == 'actions' and show_actions %}
                    <script type="text/javascript">
                        $(function() {
                            $('#bulk_actions').NavIt({ArrowSideOnRight: false});
                        });
                    </script>
                    <ul id="bulk_actions" class="entity_menu ui-widget ui-corner-all ui-state-default">
                        <li>
                            <a onclick="$(this).parents('ul').find('ul').slideToggle('slide')">{% trans "Actions" %}</a>
                            <ul style="float: left; position: absolute; z-index: 10; display: none;" class="ui-widget ui-widget-content ui-corner-all">
                                <li>
                                    <a style="white-space: nowrap;" onclick="creme.lv_widget.deleteSelectedLines($('form[name=list_view_form]'));">
                                        <img border="0" src="{% creme_media_url 'images/delete_22.png' %}" alt="{% trans "Multiple deletion" %}" title="{% trans "Multiple deletion" %}"/>{% trans "Multiple deletion" %}
                                    </a>
                                </li>
                                <li>
                                    <a style="white-space: nowrap;" onclick="creme.lv_widget.addToSelectedLines($('form[name=list_view_form]'), '/creme_core/property/add_to_entities/{{content_type_id}}/');">
                                        <img border="0" src="{% creme_media_url 'images/property_22.png' %}" alt="{% trans "Multiple property adding" %}" title="{% trans "Multiple property adding" %}"/>{% trans "Multiple property adding" %}
                                    </a>
                                </li>
                                <li>
                                    <a style="white-space: nowrap;" onclick="creme.lv_widget.addToSelectedLines($('form[name=list_view_form]'), '/creme_core/relation/add_to_entities/{{content_type_id}}/');">
                                        <img border="0" src="{% creme_media_url 'images/link_22.png' %}" alt="{% trans "Multiple relationship adding" %}" title="{% trans "Multiple relationship adding" %}"/>{% trans "Multiple relationship adding" %}
                                    </a>
                                </li>
                                <li>
                                    <a style="white-space: nowrap;" onclick="creme.lv_widget.editSelectedLines($('form[name=list_view_form]'), '/creme_core/entity/edit/bulk/{{content_type_id}}/%s');">
                                        <img border="0" src="{% creme_media_url 'images/edit_22.png' %}" alt="{% trans "Multiple update" %}" title="{% trans "Multiple update" %}"/>{% trans "Multiple update" %}
                                    </a>
                                </li>
                            </ul>
                        </li>
                    </ul>
                {% endif %}
            </th>
        {% endwith %}{% endwith %}
    {% endfor %}
</tr>
