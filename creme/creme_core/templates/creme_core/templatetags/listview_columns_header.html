{% load i18n creme_core_tags creme_listview creme_widgets %}
<tr id="list_thead_search" class="columns_bottom">
{#    {% if not o2m %}<th class="choices"><center><input name="select_all" value="all" type="checkbox" title="{% trans 'Select all' %}"/></center></th>{% endif %} #}
    {% if not o2m %}<th class="choices">&nbsp;</th>{% endif %}
    {% for cell in cells %}
        {% with cell.widget_ctx as widget_ctx %}{% with widget_ctx.type as widget_type %}
            <th {% if cell.is_hidden %}style="display:none;"{% endif %}
{#                class="{% if cell.key == list_view_state.sort_field %}sorted {% endif %}{% if cell.type_id != 'actions' %}column {{cell.header_listview_css_class}}{% else %}actions{% endif %}{% if widget_ctx.value %} search{% endif %}{% if cell.sortable %} sortable{% endif %}{% if cell.has_a_filter %} {{widget_type}}{% endif %}" #}
                class="{% if cell.key == list_view_state.sort_field %}sorted {% endif %}{% if cell.type_id != 'actions' %}column {{cell.header_listview_css_class}} {{cell.listview_css_class}}{% else %}actions{% endif %}{% if widget_ctx.value %} search{% endif %}{% if cell.sortable %} sortable{% endif %}{% if cell.has_a_filter %} {{widget_type}}{% endif %}"
                colspan="{{cell|listview_column_colspan:is_popup_view}}">
                {% if cell.has_a_filter %}
                    {% if widget_type == 'select' %}
                        <select name="{{cell.key}}" title="{{cell.title}}">
                            <option value="">{% trans 'All' %}</option>
                            {% for options in widget_ctx.values %}
                                <option value="{{options.value}}" {% if search %}{{options.selected}}{% endif %} {% if options.value == NULL_FK %}class="search-nullfk"{% endif %}>{{options.text}}</option>
                            {% endfor %}
                        </select>
                    {% elif widget_type == 'checkbox' %}
                        <select name="{{cell.key}}" title="{{cell.title}}">
                            <option value="">{% trans 'All' %}</option>
                            {% for options in widget_ctx.values %}
                                <option value="{{options.value}}" {% if search %}{{options.selected}}{% endif %}>{{options.text}}</option>
                            {% endfor %}
                        </select>
                    {% elif widget_type == 'datefield' %}
                        <div class="lv-search-daterange">
                            <div class="date-start">
                                <label for="id_{{cell.key}}{{whoami}}">{% trans 'Start' %}</label>
                                <input name="{{cell.key}}" id="id_{{cell.key}}{{whoami}}" title="{{cell.title}}"
                                       type="{{widget_type}} " data-format="{{widget_ctx.format}}"
                                       value="{% if search %}{{widget_ctx.values.start}}{% endif %}"/>
                            </div>
                            <div class="date-end">
                                <label for="id_{{cell.key}}{{whoami}}_2">{% trans 'End' %}</label>
                                <input name="{{cell.key}}" id="id_{{cell.key}}{{whoami}}_2" title="{{cell.title}}"
                                       type="{{widget_type}}" data-format="{{widget_ctx.format}}"
                                       value="{% if search %}{{widget_ctx.values.end}}{% endif %}"/>
                            </div>
                        </div>
                    {% elif widget_type == 'text' %}
                        <input name="{{cell.key}}" title="{{cell.title}}" type="text" value="{% if search %}{{widget_ctx.value}}{% endif %}" />
                    {% endif %}
                {% endif %}
                {% if cell.type_id == 'actions' and show_actions %}<span class='lv-search-title'>{% trans 'Quick search' %}</span>{% endif %}
{% comment %}
                {% if cell.type_id == 'actions' and show_actions %}
                    <ul id="bulk_actions" class="lv-header-action-list entity_menu ui-widget ui-corner-all ui-state-default">
                        <li class="lv-action-list">
                            <a class="lv-action-toggle">{% trans 'Actions' %}</a>
                            <ul style="float: left; position: absolute; z-index: 10; display: none;" class="ui-widget ui-widget-content ui-corner-all">
                                <li>
{#                                    <a style="white-space: nowrap;" onclick="creme.lv_widget.deleteSelectedLines($('form[name=list_view_form]'));"> #}
                                    <a style="white-space: nowrap;" onclick="creme.lv_widget.deleteSelectedLines(creme.lv_widget.findList(this), '{% url 'creme_core__delete_entities' %}');">
                                        {% widget_icon name='delete' label=_('Delete') size='listview-menu' %}{% trans 'Multiple deletion' %}
                                    </a>
                                </li>
                                <li>
{#                                    <a style="white-space: nowrap;" onclick="creme.lv_widget.addToSelectedLines($('form[name=list_view_form]'), '/creme_core/property/add_to_entities/{{content_type_id}}/');"> #}
                                    <a style="white-space: nowrap;" onclick="creme.lv_widget.addToSelectedLines(creme.lv_widget.findList(this), '{% url 'creme_core__add_properties_bulk' content_type_id %}');">
                                        {% widget_icon name='property' label=_('Property') size='listview-menu' %}{% trans 'Multiple property adding' %}
                                    </a>
                                </li>
                                <li>
{#                                    <a style="white-space: nowrap;" onclick="creme.lv_widget.addToSelectedLines($('form[name=list_view_form]'), '/creme_core/relation/add_to_entities/{{content_type_id}}/');"> #}
                                    <a style="white-space: nowrap;" onclick="creme.lv_widget.addToSelectedLines(creme.lv_widget.findList(this), '{% url 'creme_core__create_relations_bulk' content_type_id %}');">
                                        {% widget_icon name='relations' label=_('Relationship') size='listview-menu' %}{% trans 'Multiple relationship adding' %}
                                    </a>
                                </li>
                                <li>
{#                                    <a style="white-space: nowrap;" onclick="creme.lv_widget.editSelectedLines($('form[name=list_view_form]'), '/creme_core/entity/edit/bulk/{{content_type_id}}/%s');"> #}
                                    <a style="white-space: nowrap;" onclick="creme.lv_widget.editSelectedLines(creme.lv_widget.findList(this), '{% url 'creme_core__bulk_update' content_type_id %}');">
                                        {% widget_icon name='edit' label=_('Edit') size='listview-menu' %}{% trans 'Multiple update' %}
                                    </a>
                                </li>
                                {% if can_merge_entities %}
                                    <li>
                                        <a style="white-space: nowrap;" onclick="creme.lv_widget.mergeSelectedLines(creme.lv_widget.findList(this), '{% url 'creme_core__merge_entities' %}');">
                                            {% widget_icon name='merge' label=_('Merge') size='listview-menu' %}{% trans 'Merge 2 entities' %}
                                        </a>
                                    </li>
                                {% endif %}
                            </ul>
                        </li>
                    </ul>
                {% endif %}
{% endcomment %}
            </th>
        {% endwith %}{% endwith %}
    {% endfor %}
</tr>
