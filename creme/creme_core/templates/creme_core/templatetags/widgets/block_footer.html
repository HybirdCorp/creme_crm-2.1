{% load i18n %}
{% load creme_block creme_core_tags %}
{% if page.paginator.num_pages != 1 %}
    <tfoot class="collapsable">
        {% comment %}
        <tr>
            <td colspan="{{colspan}}" class="block_header_line_dark">
                {% if page.has_previous %}
                    <a class="button_link previous" onclick="creme.blocks.reload({% get_block_reload_uri %} + '&{{block_name}}_page={{page.previous_page_number}}')">
                        {% trans "Previous page" %}
                    </a>
                {% endif %}
                {% blocktrans with page_number=page.number num_pages=page.paginator.num_pages %}Page {{page_number}} / {{num_pages}}{% endblocktrans %}
                {% if page.has_next %}
                    <a class="button_link next" onclick="creme.blocks.reload({% get_block_reload_uri %} + '&{{block_name}}_page={{page.next_page_number}}')">
                        {% trans "Next page" %}
                    </a>
                {% endif %}
                &nbsp;|&nbsp;{% trans "Go to page" %}:
                <select onchange="creme.blocks.reload({% get_block_reload_uri %} + '&{{block_name}}_page='+$(this).val())" class="page_selector">
                    {% for p in page.paginator.num_pages|xrange:1 %}
                        <option value="{{p}}" {% if page.number == p %}selected{% endif %}>{{p}}</option>
                    {% endfor %}
                </select>
            </td>
        </tr>
        {% endcomment %}
        <tr>
            <td colspan="{{colspan}}" class="block_header_line_dark creme-block-pager-container">
                {% comment %}{% trans "Pages:" %}&nbsp;{% endcomment %}{% comment %} TODO: ??{% endcomment %}
                <ul class="creme-block-pager">
                    {% if page.has_previous %}
                    <li class="pager-link pager-prev">
                        <a class="ui-icon-carat-1-w ui-icon" data-page-uri="{% get_block_reload_uri %} + '&{{block_name}}_page={{page.previous_page_number}}'" title="{% trans "Previous page" %}">
                            &nbsp;&nbsp;
                        </a>
                    </li>
                    {% endif %}
                    {% with num_pages=page.paginator.num_pages page_number=page.number %}
                        {% if num_pages < 7 %}
                            {% for p in num_pages|xrange:1 %}
                                <li class="pager-link">
                                    <a {% if page_number == p %}disabled{% endif %} data-page-uri="{% get_block_reload_uri %} + '&{{block_name}}_page={{p}}'" {% if page_number != p %}title="{% blocktrans %}To page {{p}}{% endblocktrans %}"{% endif %}>{{p}}</a>
                                </li>
                            {% endfor %}
                        {% elif page_number <= 4 %}
                            {% for p in page_number|add:1|xrange:1 %}
                                <li class="pager-link">
                                    <a {% if page_number == p %}disabled{% endif %} data-page-uri="{% get_block_reload_uri %} + '&{{block_name}}_page={{p}}'" {% if page_number != p %}title="{% blocktrans %}To page {{p}}{% endblocktrans %}"{% endif %}>{{p}}</a>
                                </li>
                            {% endfor %}
                            <li class="pager-input">
                                <a title="{% trans "To another page" %}">…</a>
                                <input type="text" min="1" max="{{num_pages}}" value="{{page.next_page_number|add:1}}" data-page-uri="{% get_block_reload_uri %} + '&{{block_name}}_page=' + page" />
                            </li>
                            <li class="pager-link">
                                <a data-page-uri="{% get_block_reload_uri %} + '&{{block_name}}_page={{num_pages}}'" title="{% blocktrans %}To page {{num_pages}}{% endblocktrans %}">{{num_pages}}</a>
                            </li>
                        {% elif page_number >= num_pages|sub:3 %}
                            <li class="pager-link">
                                <a data-page-uri="{% get_block_reload_uri %} + '&{{block_name}}_page=1'" title="{% blocktrans %}To page 1{% endblocktrans %}">1</a>
                            </li>
                            <li class="pager-input">
                                <a title="{% trans "To another page" %}">…</a>
                                <input type="text" min="1" max="{{num_pages}}" value="{{page.previous_page_number|add:-1}}" data-page-uri="{% get_block_reload_uri %} + '&{{block_name}}_page=' + page" />
                            </li>
                            {% for p in num_pages|add:1|sub:page.previous_page_number|xrange:page.previous_page_number %}
                                <li class="pager-link">
                                    <a {% if page_number == p %}disabled{% endif %} data-page-uri="{% get_block_reload_uri %} + '&{{block_name}}_page={{p}}'" {% if page_number != p %}title="{% blocktrans %}To page {{p}}{% endblocktrans %}"{% endif %}>{{p}}</a>
                                </li>
                            {% endfor %}
                        {% else %}
                            <li class="pager-link">
                                <a data-page-uri="{% get_block_reload_uri %} + '&{{block_name}}_page=1'" title="{% blocktrans %}To page 1{% endblocktrans %}">1</a>
                            </li>
                            <li class="pager-input">
                                <a title="{% trans "To another page" %}">…</a>
                                <input type="text" min="1" max="{{num_pages}}" value="{{page.previous_page_number|add:-1}}" data-page-uri="{% get_block_reload_uri %} + '&{{block_name}}_page=' + page" />
                            </li>
                            {% for p in 3|xrange:page.previous_page_number %}
                                <li class="pager-link">
                                    <a {% if page_number == p %}disabled{% endif %} data-page-uri="{% get_block_reload_uri %} + '&{{block_name}}_page={{p}}'" {% if page_number != p %}title="{% blocktrans %}To page {{p}}{% endblocktrans %}"{% endif %}>{{p}}</a>
                                </li>
                            {% endfor %}
                            <li class="pager-input">
                                <a title="{% trans "To another page" %}">…</a>
                                <input type="text" min="1" max="{{num_pages}}" value="{{page.next_page_number|add:1}}" data-page-uri="{% get_block_reload_uri %} + '&{{block_name}}_page=' + page" />
                            </li>
                            <li class="pager-link">
                                <a data-page-uri="{% get_block_reload_uri %} + '&{{block_name}}_page={{num_pages}}'" title="{% blocktrans %}To page {{num_pages}}{% endblocktrans %}">{{num_pages}}</a>
                            </li>
                        {% endif %}
                    {% endwith %}
                    {% if page.has_next %}
                    <li class="pager-link pager-next">
                        <a class="ui-icon-carat-1-e ui-icon" data-page-uri="{% get_block_reload_uri %} + '&{{block_name}}_page={{page.next_page_number}}'" title="{% trans "Next page" %}">
                            &nbsp;&nbsp;
                        </a>
                    </li>
                    {% endif %}
                </ul>
            </td>
        </tr>
    </tfoot>
{% endif %}
